# Configuracion de Ruff - Linter y Formatter para Python
# Documentacion: https://docs.astral.sh/ruff/

# Configuracion General
line-length = 88  # Compatible con Black
indent-width = 4
target-version = "py312"  # Python 3.12

# Archivos y directorios a excluir
exclude = [
    ".bzr",
    ".direnv",
    ".eggs",
    ".git",
    ".git-rewrite",
    ".hg",
    ".ipynb_checkpoints",
    ".mypy_cache",
    ".nox",
    ".pants.d",
    ".pyenv",
    ".pytest_cache",
    ".pytype",
    ".ruff_cache",
    ".svn",
    ".tox",
    ".venv",
    ".vscode",
    "__pypackages__",
    "_build",
    "buck-out",
    "build",
    "dist",
    "node_modules",
    "site-packages",
    "venv",
    "alembic",
]

# Configuracion del Linter
[lint]
# Reglas activadas
# F - Pyflakes: Errores basicos de Python
# E - pycodestyle errors: Errores de estilo
# W - pycodestyle warnings: Advertencias de estilo
# I - isort: Ordenamiento de imports
# N - pep8-naming: Convenciones de nombres
# UP - pyupgrade: Modernizacion de codigo Python
# B - flake8-bugbear: Busqueda de bugs comunes
# SIM - flake8-simplify: Simplificacion de codigo
# C90 - mccabe: Complejidad ciclomatica
# ARG - flake8-unused-arguments: Argumentos sin usar
# PTH - flake8-use-pathlib: Uso de pathlib
# PL - Pylint: Reglas de Pylint
# RUF - Ruff-specific: Reglas especificas de Ruff
select = [
    "F",     # Pyflakes
    "E",     # pycodestyle errors
    "W",     # pycodestyle warnings
    "I",     # isort
    "N",     # pep8-naming
    "UP",    # pyupgrade
    "B",     # flake8-bugbear
    "SIM",   # flake8-simplify
    "C90",   # mccabe
    "ARG",   # flake8-unused-arguments
    "PTH",   # flake8-use-pathlib
    "PL",    # Pylint
    "RUF",   # Ruff-specific rules
]

# Reglas a ignorar
ignore = [
    "E501",    # Line too long (lo maneja el formatter)
    "PLR0913", # Too many arguments (com√∫n en funciones de API)
    "PLR2004", # Magic value used in comparison
    "PLR0911", # Too many return statements (aceptable en handlers)
    "PLR0912", # Too many branches (aceptable en validaciones complejas)
    "PLR0915", # Too many statements (aceptable en endpoints complejos)
    "C901",    # Complex function (para refactorizar gradualmente)
]

# Permitir auto-fix para todas las reglas
fixable = ["ALL"]
unfixable = []

# Permitir variables sin usar prefijadas con _
dummy-variable-rgx = "^(_+|(_+[a-zA-Z0-9_]*[a-zA-Z0-9]+?))$"

# Configuracion de complejidad ciclomatica
[lint.mccabe]
max-complexity = 15  # Incrementado temporalmente para evitar alertas en endpoints complejos

# Configuracion de isort
[lint.isort]
known-first-party = ["src"]
section-order = ["future", "standard-library", "third-party", "first-party", "local-folder"]

# Configuracion del Formatter
[format]
# Usar comillas dobles (como Black)
quote-style = "double"

# Indentar con espacios, no tabs
indent-style = "space"

# Respetar trailing commas magicas (como Black)
skip-magic-trailing-comma = false

# Detectar line endings automaticamente
line-ending = "auto"

# Formatear ejemplos de codigo en docstrings
docstring-code-format = true

# Longitud de linea para snippets en docstrings
docstring-code-line-length = "dynamic"
