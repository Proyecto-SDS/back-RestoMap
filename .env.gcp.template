# ============================================
# CONFIGURACIÓN PARA GOOGLE CLOUD PLATFORM
# Cloud Run + Cloud SQL PostgreSQL
# ============================================

# Esta es una plantilla para las variables de entorno
# que deben configurarse en GCP Cloud Run

# ============================================
# SECRETS (configurar en Secret Manager)
# ============================================

# Contraseña de PostgreSQL
# Secret name: restomap-db-password
# DB_PASSWORD=tu_password_super_seguro_aqui

# Clave JWT para firmar tokens
# Secret name: restomap-jwt-secret
# IMPORTANTE: DEBE ser diferente al valor de desarrollo
# JWT_SECRET_KEY=clave_aleatoria_muy_segura_minimo_32_caracteres

# ============================================
# VARIABLES DE ENTORNO (configurar en Cloud Run)
# ============================================

# Entorno de ejecución
ENV=production

# Configuración de CORS
# Reemplazar con la URL real del frontend
ALLOWED_ORIGINS=https://restomap-frontend.web.app,https://www.restomap.com

# ============================================
# BASE DE DATOS (Cloud SQL)
# ============================================

# Usuario de PostgreSQL
DB_USER=restomap_user

# Nombre de la base de datos
DB_NAME=restomap_db

# Host - Formato Unix Socket para Cloud SQL
# Reemplazar PROYECTO_ID, REGION e INSTANCE_NAME con tus valores
# Ejemplo: /cloudsql/restomap-prod:us-central1:restomap-db
DB_HOST=/cloudsql/PROYECTO_ID:REGION:INSTANCE_NAME

# NOTA: DB_PORT no es necesario cuando se usa Unix socket

# ============================================
# COMANDOS PARA CONFIGURAR EN GCP
# ============================================

# 1. Crear secrets:
# gcloud secrets create restomap-db-password --data-file=-
# gcloud secrets create restomap-jwt-secret --data-file=-

# 2. Dar permisos al servicio Cloud Run:
# gcloud secrets add-iam-policy-binding restomap-db-password \
#   --member="serviceAccount:SERVICE_ACCOUNT@PROJECT.iam.gserviceaccount.com" \
#   --role="roles/secretmanager.secretAccessor"

# 3. Deploy con variables de entorno:
# gcloud run deploy restomap-backend \
#   --image gcr.io/PROJECT_ID/restomap-backend:latest \
#   --add-cloudsql-instances PROJECT_ID:REGION:INSTANCE \
#   --set-env-vars ENV=production,DB_USER=restomap_user,DB_NAME=restomap_db,DB_HOST=/cloudsql/... \
#   --set-secrets DB_PASSWORD=restomap-db-password:latest,JWT_SECRET_KEY=restomap-jwt-secret:latest \
#   --region us-central1

# ============================================
# VERIFICACIÓN
# ============================================

# Verificar que las variables están configuradas:
# gcloud run services describe restomap-backend --region=us-central1 --format=yaml

# Ver logs:
# gcloud run services logs read restomap-backend --region=us-central1
